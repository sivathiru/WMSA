<app-header></app-header>
<ngx-spinner></ngx-spinner>
              <div class = "mt-3">
                    <form class="add-contact-form" [formGroup]="rForm">  
                                <div class="col-md-12 mt-0 offset-2 col-8 col-sm-8 offset-sm-2 offset-md-0">
                                    <div class="row">
                                        <div class="col-md-12 pt-1 pb-2 mt-1 pr-0 pl-0 transparent-form-bg">
                                            <div class="col-md-4 offset-md-0 font-12" [ngStyle]="{'display': 'inline-block'}">
                                                <div class="mb-1 row">
                                                        <div class="control-label col-md-4 pr-0 mb-0 font-weight-bold">
                                                            Task Name: 
                                                        </div>
                                                        <div class="ml-0 col-md-8">{{ singleUserData.TaskName }} </div>
                                                </div>
                                                <div class="mb-1 row">
                                                        <div class="control-label col-md-4 pr-0 mb-0 font-weight-bold">
                                                            Journal:
                                                        </div>
                                                        <div class="ml-0 col-md-8">{{ singleUserData.Jcode }}</div>
                                                </div>
                                                <div class="for mb-1 row">
                                                        <div class="control-label col-md-4 pr-0 mb-0 font-weight-bold">
                                                            Article ID: 
                                                        </div>
                                                        <div class="ml-0 col-md-8">{{ singleUserData.ARTID }} </div>
                                                </div>
                                                <div class="mb-3 row">
                                                        <div class="control-label col-md-4 pr-0 mb-0 font-weight-bold">
                                                            No of Pages:
                                                        </div>
                                                        <div class="ml-0 col-md-8">{{ singleUserData.MSPages }}</div>
                                                </div>
                                            </div>
                                            <div class="col-md-4 offset-md-0 font-12" [ngStyle]="{'display': 'inline-block'}">
                                                    <div class="mb-1 row">
                                                        <div class="control-label col-md-4 pr-0 mb-0 font-weight-bold">
                                                            Date Assigned:
                                                        </div>
                                                        <div class="ml-0 col-md-8">{{ singleUserData.Date_Assign | date: 'MMM d, y' }}</div>
                                                    </div>
                                                    <div class="mb-3 row">
                                                            <div class="control-label col-md-4 pr-0 mb-0 font-weight-bold">
                                                                Date Completed:
                                                            </div>
                                                            <div class="ml-0 col-md-8">{{ singleUserData.Date_Complete | date: 'MMM d, y' }}</div>
                                                    </div>
                                                    <div class="mb-3 row">
                                                        <div class="control-label col-md-4 pr-0 mb-0 font-weight-bold">
                                                            Status:
                                                        </div>
                                                        <span class="ml-0 col-md-8">{{ singleUserData.ArtStatus }}</span>
                                                        <!-- <textarea class="form-control col-md-5 login-input-box" formControlName = "comment" required></textarea> -->
                                                    </div>
                                            </div>
                                            <div class="col-md-4" [ngStyle]="{'display': 'inline-block'}" [ngClass]="displayFieldCss('upload')">
                                                <!-- <button class="form-group mb-1 col-md-3 d-flex flex-column cursor-pointer dowmload-file mr-0"><a class="btn btn-success font-14" id="download-ids" [attr.href]="fileUrl" [attr.download]="this.nameDownloadUrl + '.docx'" target="self"><i class="fas fa-cloud-download-alt"></i> Download</a></button> -->
                                                <button class="form-group mb-1 col-md-3 d-flex flex-column cursor-pointer dowmload-file mr-0"><a class="btn btn-success font-14" id="download-ids" [attr.href]="downloadArticleFile" target="_self"><i class="fas fa-cloud-download-alt"></i> Download</a></button>
                                                <div class="form-group mb-1 col-md-3 d-flex cursor-pointer txtlink font-weight-bold">
                                                    <input style="display: none" type="file" formControlName="upload" (change)="onFileChanged($event)" #fileInput>
                                                    <button class="inputselectfile btn btn-success font-14" *ngIf="userSelectFile" (click)="fileInput.click()">Choose File to Upload</button>
                                                    <!-- <button class="inputselectfile btn btn-success font-14" *ngIf="userUploadFile" [attr.disabled]="disableUploadButton" (click)="onUpload()"> <i class="fas fa-cloud-upload-alt"></i> Upload File</button> -->
                                                    <button class="inputselectfile btn btn-success font-14" *ngIf="userUploadFile" [attr.disabled]="disableUploadButton"> <i class="fas fa-cloud-upload-alt"></i> Upload File</button>
                                                    <span [ngStyle]="{'position':'absolute', 'left':'150px'}">{{selectedFile?.name}}</span>                                                    
                                                </div>
                                                <app-field-error-display [displayError]="isFieldValid('upload')" errorMsg="Please upload your file"></app-field-error-display>
                                                <div class="form-group mb-1 col-md-12 d-flex cursor-pointer font-14" *ngIf="hideUnauthorisedUser">
                                                    <input type="checkbox" class="mt-1 mr-1" name="changelock" id="changelock" value="">
                                                    <label for="changelock">lock user</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- <div class="row">
                                        <div class="col-md-10 offset-1 pt-1 pb-2 mt-1 transparent-form-bg">
                                            <div class="form-inline col-md-7 offset-md-0 font-12"> -->
                                                <!-- <div class="form-group for mb-1 col-md-5">
                                                    <div class="control-label col-md-7 pr-0 mb-0 font-weight-bold">
                                                        Task Name: 
                                                    </div>
                                                    <span class="ml-2">{{ singleUserData.TaskName }} </span>
                                                </div>
                                                <div class="form-group mb-1 col-md-5">
                                                    <div class="control-label col-md-7 pr-0 mb-0 font-weight-bold">
                                                        Date Assigned:
                                                    </div>
                                                    <span class="ml-2">{{ singleUserData.Date_Assign | date: 'MMM d, y' }}</span>
                                                </div>
                                                <div class="form-group mb-1 col-md-5">
                                                    <div class="control-label col-md-7 pr-0 mb-0 font-weight-bold">
                                                        Journal:
                                                    </div>
                                                    <span class="ml-2">{{ singleUserData.Jcode }}</span>
                                                </div>
                                                <div class="form-group mb-1 col-md-5">
                                                    <div class="control-label col-md-7 pr-0 mb-0 font-weight-bold">
                                                        Due Date:
                                                    </div>
                                                    <span class="ml-2">{{ singleUserData.Date_Assign | date: 'MMM d, y' }}</span>
                                                </div>
                                                <div class="clearfix"></div>
                                                <div class="form-group for mb-1 col-md-5">
                                                    <div class="control-label col-md-7 pr-0 mb-0 font-weight-bold">
                                                        Article ID: 
                                                    </div>
                                                    <span class="ml-2">{{ singleUserData.ARTID }} </span>
                                                </div>
                                                <div class="form-group mb-1 col-md-5">
                                                    <div class="control-label col-md-7 pr-0 mb-0 font-weight-bold">
                                                        Date Completed:
                                                    </div>
                                                    <span class="ml-2">{{ singleUserData.Date_Complete | date: 'MMM d, y' }}</span>
                                                </div>
                                                <div class="form-group mb-3 col-md-5">
                                                    <div class="control-label col-md-7 pr-0 mb-0 font-weight-bold">
                                                        No of Pages:
                                                    </div>
                                                    <span class="ml-2">{{ singleUserData.MSPages }}</span>
                                                </div>
                                                <div class="form-group mb-3 col-md-5">
                                                    <div class="control-label col-md-7 pr-0 mb-0 font-weight-bold">
                                                        Status:
                                                    </div>
                                                    <span class="ml-2">{{ singleUserData.ArtStatus }}</span>
                                                </div> -->
                                                
                                                <!-- <button class="form-group mb-1 col-md-3 d-flex flex-column cursor-pointer dowmload-file mr-3"><a class="btn btn-success font-14" id="styleref" [attr.href]="downloadFile('evt')" (click)="styleManual()" [attr.download]="this.nameStyleUrl + '.docx'" target="self"><i class="fas fa-book"></i> Style Manual</a></button>
                                                <button class="form-group mb-1 col-md-3 d-flex flex-column cursor-pointer dowmload-file mr-2"><a class="btn btn-success font-14" id="reference-ids" [attr.href]="downloadFile('evt')" (click)="reference()" [attr.download]="this.nameReferenceUrl + '.docx'" target="self"><i class="fas fa-sticky-note"></i> Reference</a></button> -->
                                                <!-- <button class="form-group mb-1 col-md-3 d-flex flex-column cursor-pointer dowmload-file mr-0"><a class="btn btn-success font-14" id="download-ids" [attr.href]="downloadFile('evt')" (click)="download()" [attr.download]="this.nameDownloadUrl + '.docx'" target="self"><i class="fas fa-cloud-download-alt"></i> Download</a></button>
                                                <div class="form-group mb-1 col-md-3 d-flex cursor-pointer txtlink font-weight-bold">
                                                    <input style="display: none" type="file" (change)="onFileChanged($event)" #fileInput>
                                                    <button class="inputselectfile btn btn-success font-14" *ngIf="userSelectFile" (click)="fileInput.click()">Choose File to Upload</button>
                                                    <button class="inputselectfile btn btn-success font-14" *ngIf="userUploadFile" [attr.disabled]="disableUploadButton" (click)="onUpload()"> <i class="fas fa-cloud-upload-alt"></i> Upload File</button>
                                                    <span [ngStyle]="{'position':'absolute', 'left':'150px'}">{{selectedFile?.name}}</span>
                                                </div> -->
                                                
                                                   
                                            <!-- </div>

                                           
                                        </div>
                                    </div> -->


                                    <div class="col-md-12 row">
                                            <h5>Special Instructions:</h5>
                                            <textarea class="form-control font-12 spec-instr-content" [ngStyle]="{'resize':'none'}" disabled>{{specialInfoData.specialInstruction}}</textarea>
                                            <div class="col-md-12 row">
                                                <div class="form-inline form-group mt-3 mb-3 col-md-4 font-12 p-0" [ngClass]="displayFieldCss('comment')">
                                                    <div class="control-label col-md-4 pr-0 mb-0 font-weight-bold p-0">
                                                        Comments:
                                                    </div>
                                                    <span class="ml-2 col-md-7"><textarea id="comment" formControlName="comment" class="form-control font-12" [ngStyle]="{'width':'100%','resize':'none'}"></textarea></span>
                                                    <!-- <app-field-error-display [displayError]="isFieldValid('comment')" errorMsg="Please inform your comment"></app-field-error-display> -->
                                                </div>
                                                <div class="form-inline mt-3 mb-3 col-md-4 pr-0 font-12">
                                                    <div class="control-label col-md-4 pr-0 mb-0 font-weight-bold required">
                                                        Status:
                                                    </div>
                                                    <select [ngModel]="selectedObject? selectedObject : ''" (ngModelChange)="updateSelectedValue($event)" class="form-control col-md-7 pr-0 font-12" id="journalStatus" formControlName="journalStatus" [ngStyle]="{'height':'auto'}">
                                                        <option  value="" disabled selected hidden>-- select --</option>
                                                        <option *ngFor="let item of journalStatus">{{item}}</option>
                                                    </select>
                                                    <app-field-error-display [displayError]="isFieldValid('journalStatus')" errorMsg="Please select option"></app-field-error-display>
                                                </div>
                                            </div>  
                                            <button type="submit"  class="float-right form-group mb-1 d-flex flex-column cursor-pointer dowmload-file mr-2 offset-md-6 text-white" (click)="onSubmit()"><a class="btn btn-success font-14"  target="self"> Submit</a></button>  
                                    </div>
                                </div>
                                               
                    <div class = "col-md-12" *ngIf="accessAuthorizedUser">
                            <button class="form-group mb-1 d-flex flex-column cursor-pointer dowmload-file text-white" *ngIf="showHistory == false" (click)="showOnlyHistory()"><a class="btn btn-success font-14"> History</a></button>  
                        <div *ngIf="showHistory">
                                <h5>History:</h5>
                            <table class="table table-striped table-sm mt-2" [ngStyle]="{'font-size': '12px', 'padding': '2px'}" [mfData]="historyData" #mf="mfDataTable" [mfRowsOnPage]="5">
                                    <thead class="card-text">
                                    <tr>
                                        <th style="width: 15%">
                                            <mfDefaultSorter by="name">Workname</mfDefaultSorter>
                                        </th>
                                        <th style="width: 15%">
                                            <mfDefaultSorter by="email">Name</mfDefaultSorter>
                                        </th>
                                        <th style="width: 15%">
                                            <mfDefaultSorter by="city">Date Assigned</mfDefaultSorter>
                                        </th>
                                        <th style="width: 15%">
                                            <mfDefaultSorter by="age">Due Date</mfDefaultSorter>
                                        </th>
                                        <!-- <th style="width: 15%">
                                            <mfDefaultSorter by="city">Date Completed</mfDefaultSorter>
                                        </th> -->
                                        <th style="width: 10%">
                                            <mfDefaultSorter by="city">Status </mfDefaultSorter>
                                        </th>
                                        <th style="width: 15%">
                                            <mfDefaultSorter by="city">Comments</mfDefaultSorter>
                                        </th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr *ngFor="let item of historyData">
                                        <td>{{item.Workname}}</td>
                                        <td>{{item.UserName}}</td>
                                        <td>{{item.StartTime| date: 'MMM d, y - hh:mm a'}}</td>
                                        <td>{{item.StartTime| date: 'MMM d, y - hh:mm a'}}</td>
                                        <!-- <td>{{item.StartTime | date: 'MMM d, y'}}</td>
                                        <td>{{item.StartTime | date: 'MMM d, y'}}</td> -->
                                        <!-- <td>{{item.EndTime | date: 'MMM d, y'}}</td> -->
                                        <td>{{item.Status}}</td>
                                        <td>{{item.Comments}}</td>                            
                                    </tr>
                                    </tbody>
                                    <tfoot>
                                    <tr>
                                        <td colspan="4">
                                            <mfBootstrapPaginator [rowsOnPageSet]="[5,10,25]"></mfBootstrapPaginator>
                                        </td>
                                    </tr>
                                    </tfoot>
                                </table>
                                </div>
                            </div>
                            </form>
                </div>